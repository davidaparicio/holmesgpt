user_prompt:
- "The checkout service in namespace app-115 is experiencing high latency. Investigate why."

expected_output:
  - The answer must explicitly state that queries that include a promo code are slow or all slow requests include promo code.
  - Including a query that mentions promo code is not sufficient.

tags:
  - kubernetes
  - hard
  - chain-of-causation
  - prometheus

port_forwards:
  - namespace: app-115
    service: prometheus
    local_port: 9090
    remote_port: 9090

before_test: |
  set -e  # Exit immediately if any command fails
  kubectl create namespace app-115 --save-config --dry-run=client -o yaml | kubectl apply -f - || true
  kubectl apply -f prometheus-config.yaml -n app-115
  kubectl apply -f ../../shared/prometheus.yaml -n app-115
  kubectl apply -f holmes-all-in-one-fast.yaml -n app-115
  ./run-holmes-check-curl-jq.sh
  echo "âœ… Test setup completed successfully"

after_test: |
  kubectl delete namespace app-115 || true
